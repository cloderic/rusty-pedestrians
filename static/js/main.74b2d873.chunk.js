(this["webpackJsonprusty-pedestrians-webapp"]=this["webpackJsonprusty-pedestrians-webapp"]||[]).push([[0],{45:function(e,t,n){e.exports=n(56)},56:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),o=n(35),c=n.n(o),i=n(6),l=n(19),s=n(12),u=n(10),d=n(17),m=n(28);n(50);function h(){var e=Object(l.a)(["\n      html {\n        // Border box\n        *,\n        *::before,\n        *::after {\n          box-sizing: border-box;\n        }\n      }\n      body {\n        min-height: 100vh;\n      }\n\n      a,\n      button {\n        color: inherit;\n        cursor: pointer;\n        background: none;\n        border: none;\n        &:active,\n        &:focus {\n          color: ",";\n          outline: none;\n        }\n        &:hover {\n          color: ",";\n        }\n        &:disabled {\n          filter: opacity(50%);\n          &:hover {\n            cursor: not-allowed;\n          }\n        }\n      }\n    "]);return h=function(){return e},e}var f=function(){return r.a.createElement(d.a,{styles:Object(d.c)(h(),Object(m.a)(.05,"#f77976"),"#f77976")})},b=n(0),p=n(59),g=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:512,a=n/(2*Math.max(e,t)),r=[e*a,t*a],o=document.createElement("canvas");o.width=n,o.height=n;var c=o.getContext("2d"),i=c.createRadialGradient(n/2,n/2,r[0],n/2,n/2,r[1]);return i.addColorStop(0,"white"),i.addColorStop(1,"black"),c.fillStyle=i,c.fillRect(0,0,n,n),new b.CanvasTexture(o)},v=function(e){var t=e.radius,n=e.color,o=e.outerGlow,c=void 0!==o&&o,i=e.width,l=void 0===i?.15:i,s=e.segments,u=void 0===s?100:s,d=Object(a.useMemo)((function(){return g(t,c?t+l:t-l)}),[t,l,c]);return r.a.createElement("mesh",{rotation:[-Math.PI/2,0,0]},c?r.a.createElement("ringBufferGeometry",{args:[t,t+l,u]}):r.a.createElement("ringBufferGeometry",{args:[t-l,t,u]}),r.a.createElement("meshBasicMaterial",{color:new b.Color(n),alphaMap:d,transparent:!0}))},E=new b.Vector3(1,0,.5).normalize(),j="".concat("/rusty-pedestrians","/assets/pedestrian.gltf"),O=function(e){var t=e.radius,n=e.height,a=e.color,o=Object(u.a)(e,["radius","height","color"]);return r.a.createElement("mesh",Object.assign({position:[0,n/2,0]},o),r.a.createElement("cylinderBufferGeometry",{args:[t,t,n,20]}),r.a.createElement("meshStandardMaterial",{color:a}))},w=function(e){var t=e.radius,n=e.height,a=e.color,o=Object(u.a)(e,["radius","height","color"]),c=Object(p.a)(j).nodes;return r.a.createElement("mesh",Object.assign({geometry:c.Pedestrian.geometry,scale:[t,n,t],rotation:[0,-Math.PI/2,0]},o),r.a.createElement("meshStandardMaterial",{color:a}))},y=function(e){return r.a.createElement(a.Suspense,{fallback:r.a.createElement(O,e)},r.a.createElement(w,e))},S=function(e){var t=e.position,n=e.direction,o=e.radius,c=e.selected,l=e.height,s=void 0===l?2:l,u=e.onClick,d=Object(a.useState)("#ff0000"),h=Object(i.a)(d,2),f=h[0],p=h[1];return Object(a.useEffect)((function(){var e=new b.Vector3(t.x,0,-t.y),n=Math.max(-.5,Math.min(.5,e.dot(E)/10))+.5;p(Object(m.b)(n,"#ff0000","#0000ff"))}),[]),r.a.createElement("group",{position:[t.x,0,-t.y],rotation:[0,Math.atan2(n.y,n.x),0]},r.a.createElement(y,{radius:o,height:s,color:f,castShadow:!0,onClick:u}),c?r.a.createElement(v,{radius:o,size:.05,color:"#4af2a1",outerGlow:!0}):null)},x=function(e){var t=e.origin,n=e.altitude,o=e.direction,c=e.color,i=e.width,l=void 0===i?.15:i,s=e.length,u=void 0===s?512:s,d=Object(a.useMemo)((function(){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:512,t=document.createElement("canvas");t.width=e,t.height=e;var n=t.getContext("2d"),a=n.createLinearGradient(0,e/2,e,e/2);return a.addColorStop(0,"white"),a.addColorStop(1,"black"),n.fillStyle=a,n.fillRect(0,0,e,e),new b.CanvasTexture(t)}()}),[]);return r.a.createElement("group",{position:[t.x,n,-t.y],rotation:[0,Math.atan2(o.y,o.x),0]},r.a.createElement("mesh",{position:[0,0,-l/2],rotation:[-Math.PI/2,0,Math.PI/2]},r.a.createElement("planeBufferGeometry",{args:[l,u]}),r.a.createElement("meshBasicMaterial",{color:new b.Color(c),alphaMap:d,transparent:!0})))},C=n(58),M=new b.Color("#0068FF"),k=new b.Color("#310fb8"),I=new b.Color("#0068FF"),B=new b.Color("#39B92C"),_=new b.Color("#ff6442"),G=function(e){var t=e.agent,n=e.orca_constraints;return r.a.createElement("group",null,r.a.createElement("group",{position:[t.position.x,0,-t.position.y]},n.map((function(e,t){var n=Object(i.a)(e,2),a=n[0],o=n[1];return r.a.createElement(x,{key:t,altitude:.05*t,origin:a,direction:o,color:_})})),r.a.createElement("group",{position:[0,.05*n.length,0]},r.a.createElement(C.a,{points:[[0,0,0],[t.velocity.x,0,-t.velocity.y]],color:M}),r.a.createElement(v,{radius:t.maximum_speed,color:k}),r.a.createElement(v,{radius:t.desired_speed,color:I}))),r.a.createElement("group",{position:[t.target.x,0,-t.target.y]},r.a.createElement("mesh",null,r.a.createElement("sphereBufferGeometry",{args:[.1]}),r.a.createElement("meshStandardMaterial",{color:B}))))},P=function(e){var t=e.color,n=Object(s.d)().scene;return Object(a.useEffect)((function(){n.background=new b.Color(t)}),[n,t]),r.a.createElement(r.a.Fragment,null,r.a.createElement("ambientLight",null),r.a.createElement("directionalLight",{castShadow:!0,position:[25,50,-8],"shadow-mapSize-width":2048,"shadow-mapSize-height":2048,"shadow-camera-far":100,"shadow-camera-left":-10,"shadow-camera-right":10,"shadow-camera-top":10,"shadow-camera-bottom":-10}))},F=n(33),z=n(57),A=n(60),J=function(e){var t=e.emoji,n=e.label;return r.a.createElement("span",{role:"img",label:n},t)},R=n(42),L=function(e){var t=e.navmeshObj,n=e.color,o=Object(a.useMemo)((function(){return(new R.a).parse(t).children[0]}),[t]);return r.a.createElement("primitive",{object:o,position:[0,0,0],rotation:[-Math.PI/2,0,0],receiveShadow:!0},r.a.createElement("meshStandardMaterial",{color:n}))},q=n(43),D=n.n(q),N=function(e){var t=e.universe,n=e.selectedAgentIdx,r=e.paused,o=e.simulationFrequency,c=Object(a.useState)([]),l=Object(i.a)(c,2),s=l[0],u=l[1],d=Object(a.useState)(null),m=Object(i.a)(d,2),h=m[0],f=m[1],b=Object(a.useCallback)((function(){var e=D()(t.render_agents(),7).map((function(e,t){var n=Object(i.a)(e,7),a=n[0],r=n[1],o=n[2],c=n[3];n[4],n[5];return{index:t,position:{x:a,y:r},direction:{x:o,y:c},radius:n[6]}}));u(e),null!=n&&f(JSON.parse(t.render_debug_info(n)))}),[u,f,t,n]),p=Object(a.useState)(""),g=Object(i.a)(p,2),v=g[0],E=g[1],j=Object(a.useState)(!1),O=Object(i.a)(j,2),w=O[0],y=O[1],S=Object(a.useCallback)((function(){t.reset(),b(),y(!1)}),[t,b]);Object(a.useEffect)((function(){t.reset(),E(t.render_navmesh())}),[t,E]);var x=Object(a.useCallback)((function(){t.update(1/o),y(!0),b()}),[t,b,y,o]);return Object(a.useEffect)((function(){if(!r){var e=setInterval(x,1e3/o);return function(){return clearInterval(e)}}b()}),[t,r,b,x,o]),{agents:s,selectedAgentDebugInfo:h,navmeshObj:v,started:w,paused:r,reset:S,computeSimulationStep:x}};function T(){var e=Object(l.a)(["\n  font-size: 2rem;\n  display: flex;\n  justify-content: center;\n"]);return T=function(){return e},e}function V(){var e=Object(l.a)(["\n  height: 100vh;\n  background: ",";\n  display: flex;\n  flex-direction: column;\n"]);return V=function(){return e},e}Object(z.a)();var W=F.a.div(V(),"#808080"),U=F.a.div(T()),$=function(e){var t=e.universe,n=Object(a.useState)(null),o=Object(i.a)(n,2),c=o[0],l=o[1],u=Object(a.useCallback)((function(){l(null)}),[l]),d=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=Object(a.useState)(e),n=Object(i.a)(t,2),r=n[0],o=n[1],c=Object(a.useCallback)((function(){o((function(e){return!e}))}),[]);return[r,c]}(!0),m=Object(i.a)(d,2),h=m[0],b=m[1],p=N({universe:t,selectedAgentIdx:c,paused:h,simulationFrequency:60}),g=p.agents,v=p.navmeshObj,E=p.computeSimulationStep,j=p.selectedAgentDebugInfo,O=p.started,w=p.reset;return r.a.createElement(r.a.Fragment,null,r.a.createElement(f,null),r.a.createElement(W,null,r.a.createElement(s.a,{camera:{position:[0,80,0],fov:10},shadowMap:!0,onPointerMissed:u},r.a.createElement(P,{color:"#808080"}),g.map((function(e){var t=e.index,n=e.position,a=e.direction,o=e.radius;return r.a.createElement(S,{key:t,position:n,direction:a,radius:o,onClick:l.bind(null,t),selected:t===c})})),j?r.a.createElement(G,j):null,r.a.createElement(L,{color:"#505050",navmeshObj:v}),r.a.createElement(A.a,null)),r.a.createElement(U,null,r.a.createElement("button",{onClick:b,name:"toggle-play-pause"},h?r.a.createElement(J,{emoji:"\u25b6\ufe0f",label:"Play"}):r.a.createElement(J,{emoji:"\u23f8",label:"Pause"})),r.a.createElement("button",{onClick:E,name:"single-step",disabled:!h},r.a.createElement(J,{emoji:"\u23ed",label:"Single Step"})),r.a.createElement("button",{onClick:w,name:"reset",disabled:!O},r.a.createElement(J,{emoji:"\u21a9\ufe0f",label:"Reset"})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)})),n.e(3).then(n.bind(null,63)).then((function(e){var t=e.Universe.new();t.load_scenario(JSON.stringify({scenario:"Corridor",agents_per_side_count:1,length:15,width:1.5})),c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement($,{universe:t})),document.getElementById("root"))})).catch((function(e){return console.error("Error importing `index.js`:",e)}))}},[[45,1,2]]]);
//# sourceMappingURL=main.74b2d873.chunk.js.map