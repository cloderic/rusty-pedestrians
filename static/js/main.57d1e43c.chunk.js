(this["webpackJsonprusty-pedestrians-webapp"]=this["webpackJsonprusty-pedestrians-webapp"]||[]).push([[0],{57:function(e,t,n){e.exports=n(85)},85:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),o=n(21),c=n.n(o),i=n(8),l=n(9),s=n(26),u=n(15),m=n(13),d=n(4),b=n(23);n(62);function f(){var e=Object(s.a)(["\n      html {\n        // Border box\n        *,\n        *::before,\n        *::after {\n          box-sizing: border-box;\n        }\n      }\n      body {\n        min-height: 100vh;\n      }\n\n      a,\n      button {\n        color: inherit;\n        cursor: pointer;\n        background: none;\n        border: none;\n        &:active,\n        &:focus {\n          color: ",";\n          outline: none;\n        }\n        &:hover {\n          color: ",";\n        }\n        &:disabled {\n          filter: opacity(50%);\n          &:hover {\n            cursor: not-allowed;\n          }\n        }\n      }\n    "]);return f=function(){return e},e}var h=function(e){var t=Object(i.a)(Object(i.a)({},e),{},{colors:Object(i.a)(Object(i.a)({},e.colors),{},{primary:"#f77976",primary75:Object(b.a)(.25,"#f77976"),primary50:Object(b.a)(.5,"#f77976"),primary25:Object(b.a)(.25,"#f77976")}),spacing:{baseUnit:2}});return console.log("customTheme",t),t},p=function(){return r.a.createElement(d.c,{styles:Object(d.e)(f(),Object(b.a)(.05,"#f77976"),"#f77976")})},g=n(0),v=n(88),j=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:512,a=n/(2*Math.max(e,t)),r=[e*a,t*a],o=document.createElement("canvas");o.width=n,o.height=n;var c=o.getContext("2d"),i=c.createRadialGradient(n/2,n/2,r[0],n/2,n/2,r[1]);return i.addColorStop(0,"white"),i.addColorStop(1,"black"),c.fillStyle=i,c.fillRect(0,0,n,n),new g.CanvasTexture(o)},E=function(e){var t=e.radius,n=e.color,o=e.outerGlow,c=void 0!==o&&o,i=e.width,l=void 0===i?.15:i,s=e.segments,u=void 0===s?100:s,m=Object(a.useMemo)((function(){return j(t,c?t+l:t-l)}),[t,l,c]);return r.a.createElement("mesh",{rotation:[-Math.PI/2,0,0]},c?r.a.createElement("ringBufferGeometry",{args:[t,t+l,u]}):r.a.createElement("ringBufferGeometry",{args:[t-l,t,u]}),r.a.createElement("meshBasicMaterial",{color:new g.Color(n),alphaMap:m,transparent:!0}))},O=new g.Vector3(1,0,.5).normalize(),y="".concat("/rusty-pedestrians","/assets/pedestrian.gltf"),w=function(e){var t=e.radius,n=e.height,a=e.color,o=Object(m.a)(e,["radius","height","color"]);return r.a.createElement("mesh",Object.assign({position:[0,n/2,0]},o),r.a.createElement("cylinderBufferGeometry",{args:[t,t,n,20]}),r.a.createElement("meshStandardMaterial",{color:a}))},C=function(e){var t=e.radius,n=e.height,a=e.color,o=Object(m.a)(e,["radius","height","color"]),c=Object(v.a)(y).nodes;return r.a.createElement("mesh",Object.assign({geometry:c.Pedestrian.geometry,scale:[t,n,t],rotation:[0,-Math.PI/2,0]},o),r.a.createElement("meshStandardMaterial",{color:a}))},S=function(e){return r.a.createElement(a.Suspense,{fallback:r.a.createElement(w,e)},r.a.createElement(C,e))},x=function(e){var t=e.position,n=e.direction,o=e.radius,c=e.selected,i=e.height,s=void 0===i?2:i,u=e.onClick,m=Object(a.useState)("#ff0000"),d=Object(l.a)(m,2),f=d[0],h=d[1];return Object(a.useEffect)((function(){var e=new g.Vector3(t.x,0,-t.y),n=Math.max(-.5,Math.min(.5,e.dot(O)/10))+.5;h(Object(b.b)(n,"#ff0000","#0000ff"))}),[]),r.a.createElement("group",{position:[t.x,0,-t.y],rotation:[0,Math.atan2(n.y,n.x),0]},r.a.createElement(S,{radius:o,height:s,color:f,castShadow:!0,onClick:u}),c?r.a.createElement(E,{radius:o,size:.05,color:"#4af2a1",outerGlow:!0}):null)},k=function(e){var t=e.origin,n=e.altitude,o=e.direction,c=e.color,i=e.width,l=void 0===i?.15:i,s=e.length,u=void 0===s?512:s,m=Object(a.useMemo)((function(){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:512,t=document.createElement("canvas");t.width=e,t.height=e;var n=t.getContext("2d"),a=n.createLinearGradient(0,e/2,e,e/2);return a.addColorStop(0,"white"),a.addColorStop(1,"black"),n.fillStyle=a,n.fillRect(0,0,e,e),new g.CanvasTexture(t)}()}),[]);return r.a.createElement("group",{position:[t.x,n,-t.y],rotation:[0,Math.atan2(o.y,o.x),0]},r.a.createElement("mesh",{position:[0,0,-l/2],rotation:[-Math.PI/2,0,Math.PI/2]},r.a.createElement("planeBufferGeometry",{args:[l,u]}),r.a.createElement("meshBasicMaterial",{color:new g.Color(c),alphaMap:m,transparent:!0})))},M=n(87),I=new g.Color("#0068FF"),_=new g.Color("#310fb8"),B=new g.Color("#0068FF"),P=new g.Color("#39B92C"),G=new g.Color("#ff6442"),F=function(e){var t=e.agent,n=e.orca_constraints;return r.a.createElement("group",null,r.a.createElement("group",{position:[t.position.x,0,-t.position.y]},n.map((function(e,t){var n=Object(l.a)(e,2),a=n[0],o=n[1];return r.a.createElement(k,{key:t,altitude:.05*t,origin:a,direction:o,color:G})})),r.a.createElement("group",{position:[0,.05*n.length,0]},r.a.createElement(M.a,{points:[[0,0,0],[t.velocity.x,0,-t.velocity.y]],color:I}),r.a.createElement(E,{radius:t.maximum_speed,color:_}),r.a.createElement(E,{radius:t.desired_speed,color:B}))),r.a.createElement("group",{position:[t.target.x,0,-t.target.y]},r.a.createElement("mesh",null,r.a.createElement("sphereBufferGeometry",{args:[.1]}),r.a.createElement("meshStandardMaterial",{color:P}))))},z=function(e){var t=e.color,n=Object(u.d)().scene;return Object(a.useEffect)((function(){n.background=new g.Color(t)}),[n,t]),r.a.createElement(r.a.Fragment,null,r.a.createElement("ambientLight",null),r.a.createElement("directionalLight",{castShadow:!0,position:[25,50,-8],"shadow-mapSize-width":2048,"shadow-mapSize-height":2048,"shadow-camera-far":100,"shadow-camera-left":-10,"shadow-camera-right":10,"shadow-camera-top":10,"shadow-camera-bottom":-10}))},A=n(44),J=n(86),R=n(89),L=function(e){var t=e.emoji,n=e.label;return r.a.createElement("span",{role:"img",label:n},t)},N=n(55),T=n(53),V=function(e){var t=e.navmeshObj,n=e.color,o=Object(a.useMemo)((function(){return(new T.a).parse(t).children[0]}),[t]);return r.a.createElement("primitive",{object:o,position:[0,0,0],rotation:[-Math.PI/2,0,0],receiveShadow:!0},r.a.createElement("meshStandardMaterial",{color:n}))},q=n(54),D=n.n(q),U=function(e){var t=e.universe,n=e.scenario,r=e.selectedAgentIdx,o=e.paused,c=e.simulationFrequency,i=Object(a.useState)([]),s=Object(l.a)(i,2),u=s[0],m=s[1],d=Object(a.useState)(null),b=Object(l.a)(d,2),f=b[0],h=b[1],p=Object(a.useCallback)((function(){var e=D()(t.render_agents(),7).map((function(e,t){var n=Object(l.a)(e,7),a=n[0],r=n[1],o=n[2],c=n[3];n[4],n[5];return{index:t,position:{x:a,y:r},direction:{x:o,y:c},radius:n[6]}}));m(e),null!=r&&r<e.length?h(JSON.parse(t.render_debug_info(r))):h(null)}),[m,h,t,r]),g=Object(a.useState)(!1),v=Object(l.a)(g,2),j=v[0],E=v[1],O=Object(a.useState)(!1),y=Object(l.a)(O,2),w=y[0],C=y[1],S=Object(a.useCallback)((function(){var e=JSON.stringify(n);t.load_scenario(e),p(),C(t.render_navmesh()),E(!1)}),[t,p,n]);Object(a.useEffect)(S,[S]);var x=Object(a.useCallback)((function(){t.update(1/c),E(!0),p()}),[t,p,E,c]);return Object(a.useEffect)((function(){if(!o){var e=setInterval(x,1e3/c);return function(){return clearInterval(e)}}p()}),[t,o,p,x,c]),{agents:u,selectedAgentDebugInfo:f,navmeshObj:w,started:j,paused:o,restart:S,computeSimulationStep:x}},W={"Antipodal Circle - 9":{scenario:"AntipodalCircle",agents_count:9,radius:6},"Corridor - 2":{scenario:"Corridor",agents_per_side_count:1,length:15,width:1.5}};function $(){var e=Object(s.a)(["\n  display: flex;\n  justify-content: flex-start;\n  align-items: center;\n  padding: 0.5rem;\n  .buttons {\n    flex 1 1;\n    display: flex;\n    justify-content: center;\n    button {\n      height: 2rem;\n      line-height: 2rem;\n      font-size: 2rem;\n    }\n  }\n"]);return $=function(){return e},e}function H(){var e=Object(s.a)(["\n  height: 100vh;\n  background: ",";\n  display: flex;\n  flex-direction: column;\n"]);return H=function(){return e},e}Object(J.a)();var K=A.a.div(H(),"#808080"),Q=A.a.div($()),X=Object.keys(W).map((function(e){return{label:e,value:W[e]}})),Y={container:function(e){return Object(i.a)(Object(i.a)({},e),{},{width:"250px",height:"2rem"})}},Z=function(e){var t=e.universe,n=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=Object(a.useState)(e),n=Object(l.a)(t,2),r=n[0],o=n[1],c=Object(a.useCallback)((function(){o((function(e){return!e}))}),[]);return[r,c]}(!0),o=Object(l.a)(n,2),c=o[0],i=o[1],s=Object(a.useState)(null),m=Object(l.a)(s,2),d=m[0],b=m[1],f=Object(a.useCallback)((function(){b(null)}),[b]),g=Object(a.useState)(X[0].value),v=Object(l.a)(g,2),j=v[0],E=v[1],O=Object(a.useCallback)((function(e){var t=e.value;return c||i(),E(t),"set-value"}),[E,c,i]),y=U({universe:t,scenario:j,selectedAgentIdx:d,paused:c,simulationFrequency:60}),w=y.agents,C=y.navmeshObj,S=y.computeSimulationStep,k=y.selectedAgentDebugInfo,M=y.started,I=y.restart;return r.a.createElement(r.a.Fragment,null,r.a.createElement(p,null),r.a.createElement(K,null,r.a.createElement(u.a,{camera:{position:[0,80,0],fov:10},shadowMap:!0,onPointerMissed:f},r.a.createElement(z,{color:"#808080"}),w.map((function(e){var t=e.index,n=e.position,a=e.direction,o=e.radius;return r.a.createElement(x,{key:t,position:n,direction:a,radius:o,onClick:b.bind(null,t),selected:t===d})})),k?r.a.createElement(F,k):null,r.a.createElement(V,{color:"#505050",navmeshObj:C}),r.a.createElement(R.a,null)),r.a.createElement(Q,null,r.a.createElement("div",{className:"buttons"},r.a.createElement("button",{onClick:i,name:"toggle-play-pause"},c?r.a.createElement(L,{emoji:"\u25b6\ufe0f",label:"Play"}):r.a.createElement(L,{emoji:"\u23f8",label:"Pause"})),r.a.createElement("button",{onClick:S,name:"single-step",disabled:!c},r.a.createElement(L,{emoji:"\u23ed",label:"Single Step"})),r.a.createElement("button",{onClick:I,name:"restart",disabled:!M},r.a.createElement(L,{emoji:"\u21a9\ufe0f",label:"Restart"}))),r.a.createElement(N.a,{options:X,defaultValue:X[0],onChange:O,isClearable:!1,menuPlacement:"top",styles:Y,theme:h}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)})),n.e(3).then(n.bind(null,92)).then((function(e){var t=e.Universe.new();c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(Z,{universe:t})),document.getElementById("root"))})).catch((function(e){return console.error("Error importing `rusty-pedestrians-engine`: ",e)}))}},[[57,1,2]]]);
//# sourceMappingURL=main.57d1e43c.chunk.js.map